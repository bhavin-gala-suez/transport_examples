import json, csv

import time
from datetime import date


# print time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int('1347517370')))



s = '{"LogMsg":[{"PE":128,"UID":"WISE-4010LAN_00D0C9E39FA6","TIM":"1600478309","Record":[[0, 0, 4,  0],[0, 1, 4,  0],[0, 2, 4,  0],[0, 3, 4,  0],[0, 0, 7, 4095],[0, 0,11,         8],[0, 1, 7, 4095],[0, 1,11,         8],[0, 2, 7, 4095],[0, 2,11,         8],[0, 3, 7, 4095],[0, 3,11,         8]]},{"PE":128,"UID":"WISE-4010LAN_00D0C9E39FA6","TIM":"1600478369","Record":[[0, 0, 4,  0],[0, 1, 4,  0],[0, 2, 4,  0],[0, 3, 4,  0],[0, 0, 7, 4095],[0, 0,11,         8],[0, 1, 7, 4095],[0, 1,11,         8],[0, 2, 7, 4095],[0, 2,11,         8],[0, 3, 7, 4095],[0, 3,11,         8]]},{"PE":128,"UID":"WISE-4010LAN_00D0C9E39FA6","TIM":"1600478429","Record":[[0, 0, 4,  0],[0, 1, 4,  0],[0, 2, 4,  0],[0, 3, 4,  0],[0, 0, 7, 4095],[0, 0,11,         8],[0, 1, 7, 4095],[0, 1,11,         8],[0, 2, 7, 4095],[0, 2,11,         8],[0, 3, 7, 4095],[0, 3,11,         8]]},{"PE":128,"UID":"WISE-4010LAN_00D0C9E39FA6","TIM":"1600478489","Record":[[0, 0, 4,  0],[0, 1, 4,  0],[0, 2, 4,  0],[0, 3, 4,  0],[0, 0, 7, 4095],[0, 0,11,         8],[0, 1, 7, 4095],[0, 1,11,         8],[0, 2, 7, 4095],[0, 2,11,         8],[0, 3, 7, 4095],[0, 3,11,         8]]},{"PE":128,"UID":"WISE-4010LAN_00D0C9E39FA6","TIM":"1600478549","Record":[[0, 0, 4,  0],[0, 1, 4,  0],[0, 2, 4,  0],[0, 3, 4,  0],[0, 0, 7, 4095],[0, 0,11,         8],[0, 1, 7, 4095],[0, 1,11,         8],[0, 2, 7, 4095],[0, 2,11,         8],[0, 3, 7, 4095],[0, 3,11,         8]]}]}'

res = json.loads(s)
# print res['LogMsg']
f = csv.writer(open("test.csv", "wb"))

# # Write CSV Header, If you dont need that, remove this line
f.writerow(["timestamp", "ch1_D", "ch2_D", "ch3_D", "ch4_D", "ch1_A", "ch2_A", "ch3_A", "ch4_A"])

for x in res["LogMsg"]:
    # print x
    f.writerow([time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(int(x["TIM"]))),
                x['Record'][0][3],
                x['Record'][1][3],
                x['Record'][2][3],
                x['Record'][3][3],
                x['Record'][4][3]/1000.0,
                x['Record'][6][3]/1000.0,
                x['Record'][8][3]/1000.0,
                x['Record'][10][3]/1000.0
                 ])

